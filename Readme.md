# Readme
创建十亿数据进行排序。最终实现高效查询

暂时实现所需内容
1. 生成测试数据
2. 将数据排序并保存
3. 查询数据

### 暂定目标
实现一个能增删查改并且附带索引的简易型数据库

### 遇到的问题
#### 1. 生成测试数据过慢
##### 思路:
单线程生成测试数据
生成一个数据，向文本写出一个数据。循环十亿次

##### 改良：
- 方式1：一个线程用于生产测试数据。另一个线程用于将数据写入文本
- 方式2：多个线程生产数据，多个线程从取出数据写入文本

#### 2. 将测试数据分块排序并保存
##### 思路：
从文本中读数据，将其排序。写入文本
由于内存过小，无法一次性排序完成，所以我们改变思路：
- 从文本中读取一定量数据（自己设置
- 对其进行排序
- 写入到文件中
##### 改良：
- 方式1
    - 读取数据后我们需要将其反序列化成`model.data`类型,我们将这一步拆分。使io一直在运行不被其他占用。
    - 读取到一定内存量时，我们对其进行排序。再将数据写出到不同的文件
    - 继续开始读取内存，直到将当前文件整个排序完成

#### 3. 外排序
#### 当前外排序思路
1. 开启多个`io`，开启`io`数量为`a`。
2. 获取一行数据`io`的数据。
3. `n`为当前读取到的行数。由于当前数据是经过内排序的。所以在同一个`io`中第`n`行小于或等于`n+1`行
4. 我们使用插入法找出最值(当前为最小值)。记录其下标`min`
5. 写出到文本。
6. 回到 ->2.
7. 当前`io`获取完毕则不对当前io进行任何操作。
8. 当所有`io`获取完毕，则将`io`关闭。如还需合并，则回到 ->1.
9. 最终将所有数据输出到一个指定文件中



使用插入法获取当前数组最小
##### 优化性能
计算机科学家吉姆·格雷的Sort Benchmark网站用不同的硬件、软件环境测试了实现方法不同的多种外排序算法的效率。效率较高的算法具有以下的特征：

- 并行计算
    - 用多个磁盘驱动器并行处理数据，可以加速顺序磁盘读写。[4]
    - 在计算机上使用多线程，可在多核心的计算机上得到优化。
    - 使用异步输入输出，可以同时排序和归并，同时读写。
    - 使用多台计算机用高速网络连接，分担计算任务。[5]
- 提高硬件速度
    - 增大内存，减小磁盘读写次数，减小归并次数。
    - 使用快速的外存设备，比如15000 RPM的硬盘或固态硬盘。
    - 使用性能更优良个各种设备，比如使用多核心CPU和延迟时间更短的内存。
- 提高软件速度
    - 对于某些特殊数据，在第一阶段的排序中使用基数排序。
    - 压缩输入输出文件和临时文件。

### 学习内容
假如需要完成以上的内容，并且在性能上有一定的要求，我们就需要用到一些知识

#### io
#### 内存管理
#### []byte转string的最优方式
#### 在什么时候用什么排序
#### 二分查找法
#### 硬盘索引如何实现
#### 知名数据库底层存储方式
#### 多线程优化理解
